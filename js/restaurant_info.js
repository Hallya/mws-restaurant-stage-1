"use strict";var restaurant,map;"serviceWorker"in navigator&&(window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("registration to serviceWorker complete with scope :",e.scope)})}),navigator.serviceWorker.addEventListener("message",function(e){"confirmed"===e.data.message&&(DBHelper.switchLoaderToMap(),console.log("Switch done"))})),window.initMap=function(){fetchRestaurantFromURL().then(function(e){self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.latlng,scrollwheel:!1}),self.map.addListener("idle",function(){DBHelper.switchLoaderToMap()}),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map),fillBreadcrumb()})};var fetchRestaurantFromURL=function(){if(!self.restaurant){var e=getParameterByName("id");return e?DBHelper.fetchRestaurantById(e).then(function(e){return self.restaurant=e}).then(fillRestaurantHTML).catch(function(e){return console.error(e)}):console.error("No restaurant id in URL")}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name;var t=document.getElementById("restaurant-address");t.innerHTML=e.address,t.setAttribute("aria-label","located at "+e.address);var r=document.getElementById("restaurant-source"),a=document.getElementById("restaurant-sourceWebp");a.srcset=DBHelper.imageWebpUrlForRestaurant(e)+"-large_x1.webp 1x, "+DBHelper.imageWebpUrlForRestaurant(e)+"-large_x2.webp 2x",a.media="(min-width: 1000px)",r.srcset=DBHelper.imageUrlForRestaurant(e)+"-large_x1.jpg 1x, "+DBHelper.imageUrlForRestaurant(e)+"-large_x2.jpg 2x",r.media="(min-width: 1000px)";var n=document.getElementById("restaurant-ndSource"),i=document.getElementById("restaurant-ndSourceWebp");i.srcset=DBHelper.imageWebpUrlForRestaurant(e)+"-medium_x1.webp 1x, "+DBHelper.imageWebpUrlForRestaurant(e)+"-medium_x2.jpg 2x",i.media="(min-width: 420px)",n.srcset=DBHelper.imageUrlForRestaurant(e)+"-medium_x1.jpg 1x, "+DBHelper.imageUrlForRestaurant(e)+"-medium_x2.jpg 2x",n.media="(min-width: 420px)";var s=document.getElementById("restaurant-thSource"),l=document.getElementById("restaurant-thSourceWebp");l.srcset=DBHelper.imageWebpUrlForRestaurant(e)+"-small_x2.webp 2x, "+DBHelper.imageWebpUrlForRestaurant(e)+"-small_x1.jpg 1x",l.media="(min-width: 320px)",s.srcset=DBHelper.imageUrlForRestaurant(e)+"-small_x2.jpg 2x, "+DBHelper.imageUrlForRestaurant(e)+"-small_x1.jpg 1x",s.media="(min-width: 320px)";var o=document.getElementById("restaurant-img");o.className="restaurant-img",o.src=DBHelper.imageUrlForRestaurant(e)+"-large_x1.jpg",o.setAttribute("sizes","(max-width: 1100px) 85vw, (min-width: 1101px) 990px"),o.alt=e.name+"'s  restaurant";var d=document.getElementById("restaurant-cuisine");d.innerHTML=e.cuisine_type;var m=document.createElement("label");return m.innerHTML=e.cuisine_type+" food",m.setAttribute("hidden","hidden"),m.id="foodType",d.parentNode.insertBefore(m,d.nextSibling),e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML(),e},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var r in e){var a=document.createElement("tr"),n=document.createElement("td");n.innerHTML=r,n.setAttribute("aria-label","open on "+r),a.appendChild(n);var i=document.createElement("td");i.innerHTML=e[r],i.setAttribute("aria-label",e[r]+","),a.appendChild(i),a.setAttribute("role","row"),t.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),r=document.createElement("h3");if(r.innerHTML="Reviews",t.appendChild(r),!e){var a=document.createElement("p");return a.innerHTML="No reviews yet!",void t.appendChild(a)}var n=document.getElementById("reviews-list");e.forEach(function(e){n.appendChild(createReviewHTML(e))}),t.appendChild(n)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("p");r.className="userName",r.innerHTML=e.name,r.setAttribute("aria-label",e.name+","),t.appendChild(r);var a=document.createElement("p");a.className="dateReview",a.innerHTML=e.date,a.setAttribute("aria-label",e.date+","),t.appendChild(a);var n=document.createElement("p"),i=document.createElement("span");n.className="userRating",i.className="ratingStars";for(var s=0;s<e.rating;s++)i.innerHTML+="â˜…";i.setAttribute("aria-label",e.rating+" stars on 5,"),n.innerHTML="Rating: ",n.appendChild(i),t.appendChild(n);var l=document.createElement("p");return l.className="userComments",l.innerHTML=e.comments,t.appendChild(l),t.setAttribute("role","listitem"),t.setAttribute("aria-setsize",self.restaurant.reviews.length),t.setAttribute("aria-posinset",self.restaurant.reviews.indexOf(e)+1),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("li");r.innerHTML=" "+e.name,r.className="fontawesome-arrow-right",r.setAttribute("aria-current","page"),t.appendChild(r)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};