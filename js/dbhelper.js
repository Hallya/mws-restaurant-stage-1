class DBHelper {

  static get DATABASE_URL() {
    const path = window.location.hostname === 'hallya.github.io' ? 'data/restaurants.json' : 'http://localhost:1337/restaurants';
    // const path = 'http://localhost:1337/restaurants';
    return path;
  }

  /**
   * Fetch all restaurants.
   */
  static fetchRestaurants() {
    return fetch(DBHelper.DATABASE_URL).then(response => {
      return response.json();
    }).catch(error => console.error(`Request failed. Returned status of ${error}`));
  }

  /**
   * Fetch a restaurant by its ID.
   */
  static fetchRestaurantById(id) {
    // fetch all restaurants with proper error handling.
    return fetch(DBHelper.DATABASE_URL).then(response => response.json()).then(data => {
      return data[id - 1];
    }).catch(error => console.error(`Restaurant does not exist: ${error}`));
  }

  /**
   * Fetch restaurants by a cuisine type with proper error handling.
   */
  static fetchRestaurantByCuisine(cuisine) {
    // Fetch all restaurants  with proper error handling
    return DBHelper.fetchRestaurants().then(restaurants => restaurants.filter(r => r.cuisine_type == cuisine)).catch(error => console.error(error));
  }

  /**
   * Fetch restaurants by a neighborhood with proper error handling.
   */
  static fetchRestaurantByNeighborhood(neighborhood) {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => restaurants.filter(r => r.neighborhood == neighborhood)).catch(error => console.error(error));
  }

  /**
   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.
   */
  static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood) {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      let results = restaurants;
      if (cuisine !== 'all') {
        results = restaurants.filter(r => r.cuisine_type == cuisine);
      }
      if (neighborhood !== 'all') {
        results = restaurants.filter(r => r.neighborhood == neighborhood);
      }
      return results;
    }).catch(error => console.error(error));
  }

  /**
   * Fetch all neighborhoods with proper error handling.
   */
  static fetchNeighborhoods() {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      // Get all neighborhoods from all restaurants
      const neighborhoods = restaurants.map(restaurant => restaurant.neighborhood);
      // Remove duplicates from neighborhoods
      const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i);
      return uniqueNeighborhoods;
    }).catch(error => console.error(error));
  }

  /**
   * Fetch all cuisines with proper error handling.
   */
  static fetchCuisines() {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      // Get all cuisines from all restaurants
      const cuisines = restaurants.map(restaurant => restaurant.cuisine_type);
      // Remove duplicates from cuisines
      const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i);
      return uniqueCuisines;
    }).catch(error => console.error(error));
  }

  /**
   * Restaurant page URL.
   */
  static urlForRestaurant(restaurant) {
    return `restaurant.html?id=${restaurant.id}`;
  }

  /**
   * Restaurant image URL.
   */
  static imageUrlForRestaurant(restaurant) {
    return `assets/img/${restaurant.photograph}`;
  }

  /**q
   * Map marker for a restaurant.
   */
  static mapMarkerForRestaurant(restaurant, map) {
    const marker = new google.maps.Marker({
      position: restaurant.latlng,
      title: restaurant.name,
      url: DBHelper.urlForRestaurant(restaurant),
      map: map,
      animation: google.maps.Animation.DROP });
    return marker;
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIl0sIm5hbWVzIjpbIkRCSGVscGVyIiwiREFUQUJBU0VfVVJMIiwicGF0aCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJmZXRjaFJlc3RhdXJhbnRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwiaWQiLCJkYXRhIiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lIiwiY3Vpc2luZSIsInJlc3RhdXJhbnRzIiwiZmlsdGVyIiwiciIsImN1aXNpbmVfdHlwZSIsImZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kIiwibmVpZ2hib3Job29kIiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzdWx0cyIsImZldGNoTmVpZ2hib3Job29kcyIsIm5laWdoYm9yaG9vZHMiLCJtYXAiLCJyZXN0YXVyYW50IiwidW5pcXVlTmVpZ2hib3Job29kcyIsInYiLCJpIiwiaW5kZXhPZiIsImZldGNoQ3Vpc2luZXMiLCJjdWlzaW5lcyIsInVuaXF1ZUN1aXNpbmVzIiwidXJsRm9yUmVzdGF1cmFudCIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsInBob3RvZ3JhcGgiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwibWFya2VyIiwiZ29vZ2xlIiwibWFwcyIsIk1hcmtlciIsInBvc2l0aW9uIiwibGF0bG5nIiwidGl0bGUiLCJuYW1lIiwidXJsIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBTixDQUFlOztBQUViLGFBQVdDLFlBQVgsR0FBMEI7QUFDeEIsVUFBTUMsT0FBT0MsT0FBT0MsUUFBUCxDQUFnQkMsUUFBaEIsS0FBNkIsa0JBQTdCLEdBQWtELHVCQUFsRCxHQUE0RSxtQ0FBekY7QUFDQTtBQUNBLFdBQU9ILElBQVA7QUFDRDs7QUFFRDs7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QUFpQkQsU0FBU2hCLE1BQVQsQ0FBZ0IsQ0FBQ1ksQ0FBRCxFQUFJQyxDQUFKLEtBQVVHLFNBQVNGLE9BQVQsQ0FBaUJGLENBQWpCLEtBQXVCQyxDQUFqRCxDQUF2QjtBQUNBLGFBQU9JLGNBQVA7QUFDRCxLQVBJLEVBT0YxQixLQVBFLENBT0lDLFNBQVNDLFFBQVFELEtBQVIsQ0FBY0EsS0FBZCxDQVBiLENBQVA7QUFRRDs7QUFFRDs7O0FBR0EsU0FBTzBCLGdCQUFQLENBQXdCUixVQUF4QixFQUFvQztBQUNsQyxXQUFTLHNCQUFxQkEsV0FBV2YsRUFBRyxFQUE1QztBQUNEOztBQUVEOzs7QUFHQSxTQUFPd0IscUJBQVAsQ0FBNkJULFVBQTdCLEVBQXlDO0FBQ3ZDLFdBQVMsY0FBYUEsV0FBV1UsVUFBVyxFQUE1QztBQUNEOztBQUVEOzs7QUFHQSxTQUFPQyxzQkFBUCxDQUE4QlgsVUFBOUIsRUFBMENELEdBQTFDLEVBQStDO0FBQzdDLFVBQU1hLFNBQVMsSUFBSUMsT0FBT0MsSUFBUCxDQUFZQyxNQUFoQixDQUF1QjtBQUNwQ0MsZ0JBQVVoQixXQUFXaUIsTUFEZTtBQUVwQ0MsYUFBT2xCLFdBQVdtQixJQUZrQjtBQUdwQ0MsV0FBS2xELFNBQVNzQyxnQkFBVCxDQUEwQlIsVUFBMUIsQ0FIK0I7QUFJcENELFdBQUtBLEdBSitCO0FBS3BDc0IsaUJBQVdSLE9BQU9DLElBQVAsQ0FBWVEsU0FBWixDQUFzQkMsSUFMRyxFQUF2QixDQUFmO0FBT0EsV0FBT1gsTUFBUDtBQUNEO0FBaElZIiwiZmlsZSI6ImRiaGVscGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgREJIZWxwZXIge1xyXG5cclxuICBzdGF0aWMgZ2V0IERBVEFCQVNFX1VSTCgpIHtcclxuICAgIGNvbnN0IHBhdGggPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdoYWxseWEuZ2l0aHViLmlvJyA/ICdkYXRhL3Jlc3RhdXJhbnRzLmpzb24nIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XHJcbiAgICAvLyBjb25zdCBwYXRoID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XHJcbiAgICByZXR1cm4gcGF0aDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50cygpIHtcclxuICAgIHJldHVybiBmZXRjaChEQkhlbHBlci5EQVRBQkFTRV9VUkwpXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihgUmVxdWVzdCBmYWlsZWQuIFJldHVybmVkIHN0YXR1cyBvZiAke2Vycm9yfWApKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGEgcmVzdGF1cmFudCBieSBpdHMgSUQuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQpIHtcclxuICAgIC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgIHJldHVybiBmZXRjaChEQkhlbHBlci5EQVRBQkFTRV9VUkwpXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFbaWQgLSAxXTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3Q6ICR7ZXJyb3J9YCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpKVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCkge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCkpXHJcbiAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIHJldHVybiBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKClcclxuICAgICAgLnRoZW4ocmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICAgIGxldCByZXN1bHRzID0gcmVzdGF1cmFudHM7XHJcbiAgICAgICAgaWYgKGN1aXNpbmUgIT09ICdhbGwnKSB7XHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT09ICdhbGwnKSB7XHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKGVycm9yKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKCkge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+IHtcclxuICAgICAgICAvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKHJlc3RhdXJhbnQgPT4gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gbmVpZ2hib3Job29kc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcigodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGkpO1xyXG4gICAgICAgIHJldHVybiB1bmlxdWVOZWlnaGJvcmhvb2RzO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaEN1aXNpbmVzKCkge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+IHtcclxuICAgICAgICAvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAocmVzdGF1cmFudCA9PiByZXN0YXVyYW50LmN1aXNpbmVfdHlwZSk7XHJcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBjdWlzaW5lc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpO1xyXG4gICAgICAgIHJldHVybiB1bmlxdWVDdWlzaW5lcztcclxuICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBwYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGByZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBpbWFnZSBVUkwuXHJcbiAgICovXHJcbiAgc3RhdGljIGltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGBhc3NldHMvaW1nLyR7cmVzdGF1cmFudC5waG90b2dyYXBofWApO1xyXG4gIH1cclxuXHJcbiAgLyoqcVxyXG4gICAqIE1hcCBtYXJrZXIgZm9yIGEgcmVzdGF1cmFudC5cclxuICAgKi9cclxuICBzdGF0aWMgbWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtYXApIHtcclxuICAgIGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICBwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgIHRpdGxlOiByZXN0YXVyYW50Lm5hbWUsXHJcbiAgICAgIHVybDogREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSxcclxuICAgICAgbWFwOiBtYXAsXHJcbiAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1B9XHJcbiAgICApO1xyXG4gICAgcmV0dXJuIG1hcmtlcjtcclxuICB9XHJcbn0iXX0=
