class DBHelper {

  static get DATABASE_URL() {
    // const path = window.location.hostname === 'hallya.github.io' ? 'data/restaurants.json' : 'http://localhost:1337/restaurants';
    const path = 'data/restaurants.json';
    return path;
  }

  /**
   * Fetch all restaurants.
   */
  static fetchRestaurants() {
    return fetch(DBHelper.DATABASE_URL).then(response => response.json()).catch(error => console.error(`Request failed. Returned status of ${error}`));
  }

  /**
   * Fetch a restaurant by its ID.
   */
  static fetchRestaurantById(id) {
    // fetch all restaurants with proper error handling.
    return fetch(DBHelper.DATABASE_URL).then(response => response.json()).then(data => {
      return data.restaurants[id - 1];
    }).catch(error => console.error(`Restaurant does not exist: ${error}`));
  }

  /**
   * Fetch restaurants by a cuisine type with proper error handling.
   */
  static fetchRestaurantByCuisine(cuisine) {
    // Fetch all restaurants  with proper error handling
    return DBHelper.fetchRestaurants().then(restaurants => restaurants.restaurants.filter(r => r.cuisine_type == cuisine)).catch(error => console.error(error));
  }

  /**
   * Fetch restaurants by a neighborhood with proper error handling.
   */
  static fetchRestaurantByNeighborhood(neighborhood) {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => restaurants.restaurants.filter(r => r.neighborhood == neighborhood)).catch(error => console.error(error));
  }

  /**
   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.
   */
  static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood) {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      let results = restaurants.restaurants;
      if (cuisine !== 'all') {
        results = restaurants.restaurants.filter(r => r.cuisine_type == cuisine);
      }
      if (neighborhood !== 'all') {
        results = restaurants.restaurants.filter(r => r.neighborhood == neighborhood);
      }
      return results;
    }).catch(error => console.error(error));
  }

  /**
   * Fetch all neighborhoods with proper error handling.
   */
  static fetchNeighborhoods() {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      // Get all neighborhoods from all restaurants
      const neighborhoods = restaurants.restaurants.map(restaurant => restaurant.neighborhood);
      // Remove duplicates from neighborhoods
      const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i);
      return uniqueNeighborhoods;
    }).catch(error => console.error(error));
  }

  /**
   * Fetch all cuisines with proper error handling.
   */
  static fetchCuisines() {
    // Fetch all restaurants
    return DBHelper.fetchRestaurants().then(restaurants => {
      // Get all cuisines from all restaurants
      const cuisines = restaurants.restaurants.map(restaurant => restaurant.cuisine_type);
      // Remove duplicates from cuisines
      const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i);
      return uniqueCuisines;
    }).catch(error => console.error(error));
  }

  /**
   * Restaurant page URL.
   */
  static urlForRestaurant(restaurant) {
    return `restaurant.html?id=${restaurant.id}`;
  }

  /**
   * Restaurant image URL.
   */
  static imageUrlForRestaurant(restaurant) {
    return `assets/img/jpg/${restaurant.photograph}`;
  }

  static imageWebpUrlForRestaurant(restaurant) {
    return `assets/img/webp/${restaurant.photograph}`;
  }

  /**q
   * Map marker for a restaurant.
   */
  static mapMarkerForRestaurant(restaurant, map) {
    const marker = new google.maps.Marker({
      position: restaurant.latlng,
      title: restaurant.name,
      url: DBHelper.urlForRestaurant(restaurant),
      map: map,
      animation: google.maps.Animation.DROP });
    return marker;
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIl0sIm5hbWVzIjpbIkRCSGVscGVyIiwiREFUQUJBU0VfVVJMIiwicGF0aCIsImZldGNoUmVzdGF1cmFudHMiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJpZCIsImRhdGEiLCJyZXN0YXVyYW50cyIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZSIsImN1aXNpbmUiLCJmaWx0ZXIiLCJyIiwiY3Vpc2luZV90eXBlIiwiZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2QiLCJmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QiLCJyZXN1bHRzIiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwibmVpZ2hib3Job29kcyIsIm1hcCIsInJlc3RhdXJhbnQiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwidiIsImkiLCJpbmRleE9mIiwiZmV0Y2hDdWlzaW5lcyIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJ1cmxGb3JSZXN0YXVyYW50IiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwicGhvdG9ncmFwaCIsImltYWdlV2VicFVybEZvclJlc3RhdXJhbnQiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwibWFya2VyIiwiZ29vZ2xlIiwibWFwcyIsIk1hcmtlciIsInBvc2l0aW9uIiwibGF0bG5nIiwidGl0bGUiLCJuYW1lIiwidXJsIiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBTixDQUFlOztBQUViLGFBQVdDLFlBQVgsR0FBMEI7QUFDeEI7QUFDQSxVQUFNQyxPQUFPLHVCQUFiO0FBQ0EsV0FBT0EsSUFBUDtBQUNEOztBQUVEOzs7QUFHQSxTQUFPQyxnQkFBUCxHQUEwQjtBQUN4QixXQUFPQyxNQUFNSixTQUFTQyxZQUFmLEVBQ0pJLElB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Q0E7QUFDQSxZQUFNZSxpQkFBaUJELFNBQVNoQixNQUFULENBQWdCLENBQUNZLENBQUQsRUFBSUMsQ0FBSixLQUFVRyxTQUFTRixPQUFULENBQWlCRixDQUFqQixLQUF1QkMsQ0FBakQsQ0FBdkI7QUFDQSxhQUFPSSxjQUFQO0FBQ0QsS0FQSSxFQU9GMUIsS0FQRSxDQU9JQyxTQUFTQyxRQUFRRCxLQUFSLENBQWNBLEtBQWQsQ0FQYixDQUFQO0FBUUQ7O0FBRUQ7OztBQUdBLFNBQU8wQixnQkFBUCxDQUF3QlIsVUFBeEIsRUFBb0M7QUFDbEMsV0FBUyxzQkFBcUJBLFdBQVdmLEVBQUcsRUFBNUM7QUFDRDs7QUFFRDs7O0FBR0EsU0FBT3dCLHFCQUFQLENBQTZCVCxVQUE3QixFQUF5QztBQUN2QyxXQUFTLGtCQUFpQkEsV0FBV1UsVUFBVyxFQUFoRDtBQUNEOztBQUVELFNBQU9DLHlCQUFQLENBQWlDWCxVQUFqQyxFQUE2QztBQUMzQyxXQUFTLG1CQUFrQkEsV0FBV1UsVUFBVyxFQUFqRDtBQUNEOztBQUVEOzs7QUFHQSxTQUFPRSxzQkFBUCxDQUE4QlosVUFBOUIsRUFBMENELEdBQTFDLEVBQStDO0FBQzdDLFVBQU1jLFNBQVMsSUFBSUMsT0FBT0MsSUFBUCxDQUFZQyxNQUFoQixDQUF1QjtBQUNwQ0MsZ0JBQVVqQixXQUFXa0IsTUFEZTtBQUVwQ0MsYUFBT25CLFdBQVdvQixJQUZrQjtBQUdwQ0MsV0FBS2hELFNBQVNtQyxnQkFBVCxDQUEwQlIsVUFBMUIsQ0FIK0I7QUFJcENELFdBQUtBLEdBSitCO0FBS3BDdUIsaUJBQVdSLE9BQU9DLElBQVAsQ0FBWVEsU0FBWixDQUFzQkMsSUFMRyxFQUF2QixDQUFmO0FBT0EsV0FBT1gsTUFBUDtBQUNEO0FBbElZIiwiZmlsZSI6ImRiaGVscGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgREJIZWxwZXIge1xyXG5cclxuICBzdGF0aWMgZ2V0IERBVEFCQVNFX1VSTCgpIHtcclxuICAgIC8vIGNvbnN0IHBhdGggPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09ICdoYWxseWEuZ2l0aHViLmlvJyA/ICdkYXRhL3Jlc3RhdXJhbnRzLmpzb24nIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MTMzNy9yZXN0YXVyYW50cyc7XHJcbiAgICBjb25zdCBwYXRoID0gJ2RhdGEvcmVzdGF1cmFudHMuanNvbic7XHJcbiAgICByZXR1cm4gcGF0aDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50cygpIHtcclxuICAgIHJldHVybiBmZXRjaChEQkhlbHBlci5EQVRBQkFTRV9VUkwpXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYFJlcXVlc3QgZmFpbGVkLiBSZXR1cm5lZCBzdGF0dXMgb2YgJHtlcnJvcn1gKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUlkKGlkKSB7XHJcbiAgICAvLyBmZXRjaCBhbGwgcmVzdGF1cmFudHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICByZXR1cm4gZmV0Y2goREJIZWxwZXIuREFUQUJBU0VfVVJMKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgIHJldHVybiBkYXRhLnJlc3RhdXJhbnRzW2lkIC0gMV07XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmVycm9yKGBSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0OiAke2Vycm9yfWApKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSkge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzICB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xyXG4gICAgcmV0dXJuIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50cyA9PiByZXN0YXVyYW50cy5yZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QpIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgcmV0dXJuIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50cyA9PiByZXN0YXVyYW50cy5yZXN0YXVyYW50cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpKVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCkge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICByZXR1cm4gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAgIC50aGVuKHJlc3RhdXJhbnRzID0+IHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLnJlc3RhdXJhbnRzO1xyXG4gICAgICAgIGlmIChjdWlzaW5lICE9PSAnYWxsJykge1xyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLnJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmVpZ2hib3Job29kICE9PSAnYWxsJykge1xyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLnJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoTmVpZ2hib3Job29kcygpIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgcmV0dXJuIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLnJlc3RhdXJhbnRzLm1hcChyZXN0YXVyYW50ID0+IHJlc3RhdXJhbnQubmVpZ2hib3Job29kKTtcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKTtcclxuICAgICAgICByZXR1cm4gdW5pcXVlTmVpZ2hib3Job29kcztcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hDdWlzaW5lcygpIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgcmV0dXJuIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMucmVzdGF1cmFudHMubWFwKHJlc3RhdXJhbnQgPT4gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGUpO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKTtcclxuICAgICAgICByZXR1cm4gdW5pcXVlQ3Vpc2luZXM7XHJcbiAgICAgIH0pLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXHJcbiAgICovXHJcbiAgc3RhdGljIHVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgYXNzZXRzL2ltZy9qcGcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9YCk7XHJcbiAgfVxyXG4gIFxyXG4gIHN0YXRpYyBpbWFnZVdlYnBVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYGFzc2V0cy9pbWcvd2VicC8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaH1gKTtcclxuICB9XHJcblxyXG4gIC8qKnFcclxuICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgICovXHJcbiAgc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICAgICB1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXHJcbiAgICAgIG1hcDogbWFwLFxyXG4gICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QfVxyXG4gICAgKTtcclxuICAgIHJldHVybiBtYXJrZXI7XHJcbiAgfVxyXG59Il19
